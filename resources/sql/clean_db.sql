
-- Script which removes all database content except for tables related
-- to user roles, user groups and users

-- Create function

drop function if exists delete_rows_from_tables;

create or replace function delete_rows_from_tables(tables_to_delete text[])
returns void as
$$
declare
  table_name text;
begin
  foreach table_name in array tables_to_delete
  loop
    execute 'delete from "' || table_name || '"';
  end loop;
end;
$$
language plpgsql;

-- Remove data

select delete_rows_from_tables(array[
'keyjsonvalue',
'maplegend',
'maplegendset',
'constant',
'sqlview',
'smscodes',
'smscommandcodes',
'smscommands',
'incomingsms',
'datavalueaudit',
'datavalue',
'completedatasetregistration',
'pushanalysisrecipientusergroups',
'pushanalysis',
'audit',
'potentialduplicate',
'dashboarditem_users',
'dashboarditem_resources',
'dashboarditem_reports',
'dashboard_items',
'dashboarditem',
'dashboard',
'interpretation_comments',
'interpretationcomment',
'interpretation',
'report',
'datastatisticsevent',
'visualization_yearlyseries',
'visualization_rows',
'visualization_periods',
'visualization_orgunitlevels',
'visualization_orgunitgroupsetdimensions',
'visualization_organisationunits',
'visualization_itemorgunitgroups',
'visualization_filters',
'visualization_dataelementgroupsetdimensions',
'visualization_datadimensionitems',
'visualization_columns',
'visualization_categoryoptiongroupsetdimensions',
'visualization_categorydimensions',
'visualization_axis',
'axis',
'visualization',
'eventreport_attributedimensions',
'eventreport_columns',
'eventreport_dataelementdimensions',
'eventreport_filters',
'eventreport_itemorgunitgroups',
'eventreport_organisationunits',
'eventreport_orgunitgroupsetdimensions',
'eventreport_orgunitlevels',
'eventreport_periods',
'eventreport_programindicatordimensions',
'eventreport_rows',
'eventreport',
'eventchart_attributedimensions',
'eventchart_columns',
'eventchart_dataelementdimensions',
'eventchart_filters',
'eventchart_itemorgunitgroups',
'eventchart_organisationunits',
'eventchart_orgunitgroupsetdimensions',
'eventchart_orgunitlevels',
'eventchart_periods',
'eventchart_programindicatordimensions',
'eventchart_rows',
'eventchart',
'eventvisualization_attributedimensions',
'eventvisualization_columns',
'eventvisualization_dataelementdimensions',
'eventvisualization_filters',
'eventvisualization_itemorgunitgroups',
'eventvisualization_organisationunits',
'eventvisualization_orgunitgroupsetdimensions',
'eventvisualization_orgunitlevels',
'eventvisualization_periods',
'eventvisualization_programindicatordimensions',
'eventvisualization_rows',
'eventvisualization',
'dataelementgroupsetdimension_items',
'dataelementgroupsetdimension',
'categorydimension_items',
'categorydimension',
'categoryoptiongroupsetdimension',
'categoryoptiongroupsetdimension_items',
'orgunitgroupsetdimension_items',
'orgunitgroupsetdimension',
'program_userroles',
'users_catdimensionconstraints',
'users_cogsdimensionconstraints',
'userdatavieworgunits',
'usermembership',
'orgunitgroupsetmembers',
'orgunitgroupset',
'orgunitgroupmembers',
'orgunitgroup',
'validationrulegroupmembers',
'validationrulegroup',
'validationresult',
'validationrule',
'dataapproval',
'lockexception',
'sectiongreyedfields',
'sectiondataelements',
'section',
'datasetsource',
'datasetelement',
'datasetindicators',
'datasetoperands',
'dataset',
'dataapprovalaudit',
'dataapprovalworkflowlevels',
'dataapprovalworkflow',
'dataapprovallevel',
'predictorgroupmembers',
'predictorgroup',
'predictororgunitlevels',
'predictor',
'datadimensionitem',
'programrulevariable',
'programruleaction',
'programrule',
'programnotificationinstance',
'trackedentitydatavalueaudit',
'trackedentityprogramowner',
'programstageinstance_messageconversation',
'programstageinstancecomments',
'programinstancecomments',
'programstageinstance',
'programinstance',
'programnotificationtemplate',
'programstagedataelement',
'programstagesection_dataelements',
'programstagesection',
'programstage',
'program_organisationunits',
'program_attributes',
'periodboundary',
'programindicator',
'programownershiphistory',
'programtempownershipaudit',
'programtempowner',
'program',
'programstageinstancefilter',
'trackedentityattributevalue',
'trackedentityattributevalueaudit',
'trackedentitytypeattribute',
'trackedentityattribute',
'trackedentityinstancereminder',
'trackedentityinstanceaudit',
'trackedentityinstance',
'trackedentitytype',
'minmaxdataelement',
'dataelementgroupsetmembers',
'dataelementgroupset',
'dataelementgroupmembers',
'dataelementgroup',
'dataelementaggregationlevels',
'dataelementoperand',
'dataelement',
'categoryoptioncombos_categoryoptions',
'categorycombos_optioncombos',
'categorycombos_categories',
'categories_categoryoptions',
'userteisearchorgunits',
'categoryoption_organisationunits',
'userdatavieworgunits',
'organisationunit',
'orgunitlevel',
'version',
'deletedobject',
'period',
'indicatorgroupsetmembers',
'indicatorgroupset',
'indicatorgroupmembers',
'indicatorgroup',
'indicator',
'indicatortype',
'categoryoptiongroupsetmembers',
'categoryoptiongroupset',
'categoryoptiongroupmembers',
'categoryoptiongroup',
'expression',
'categoryoptioncombo',
'categorycombo',
'dataelementcategory',
'dataelementcategoryoption',
'optionvalue',
'optionset',
'systemsetting',
'attribute',
'messageconversation_usermessages',
'usermessage',
'messageconversation_messages',
'messageconversation',
'message',
'previouspasswords',
'fileresource',
'trackedentitycomment',
'reservedvalue',
'sequentialnumbercounter',
'jobconfiguration'
]);
